language: python
env:
  global:
    - PIP_CACHE_DIR="$HOME/.cache/pip"  # unify pip cache location for all platforms
# use cache for big builds like pandas (to minimise build time).
# If issues, clear cache
# https://docs.travis-ci.com/user/caching/#Clearing-Caches
cache:
  pip: true
  directories:
  - $HOME/.cache/pip
before_cache:
  - rm -f $HOME/.cache/pip/log/debug.log
notifications:
  email: false

env:
  - JULIA_VERSION=1.0.5
  - JULIA_VERSION=1.1.1
  - JULIA_VERSION=1.2.0
  - JULIA_VERSION=1.3.1
  - JULIA_VERSION=latest

os:
  - linux
  - osx

install:
  - pip install -r requirements.txt

# https://github.com/travis-ci/travis-ci/issues/9929
- stage: test
  os: osx
  language: sh
  env: TOXENV=py3
  addons:
    homebrew:
      update: true
      packages: python3
  before_install:
    - pip3 install virtualenv
    - virtualenv -p python3 ~/venv
    - source ~/venv/bin/activate

script:
  - make test
